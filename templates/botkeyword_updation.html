{% extends 'dashboard.html' %}

{% block title %}Keyword Updation{% endblock %}

{% block head %}
{{ super() }}
<style>
    .table-container {
        max-height: 400px;
        overflow-y: auto;
        border: 1px solid #dee2e6;
    }

    table thead th {
        position: sticky;
        top: 0;
        background-color: #343a40;
        color: white;
        z-index: 10;
    }

    table th, table td {
        vertical-align: middle !important;
        white-space: normal;
        word-break: break-word;
    }

    .form-control.form-control-sm {
        height: 30px;
        padding: 0.25rem 0.5rem;
    }
</style>
{% endblock %}

{% block content %}

<h3 class="text-center text-muted mb-3">Bot Keywords Updation</h3>

<div class="d-flex justify-content-end mb-2">
    <a href="{{ url_for('add_botkeyword_updation') }}" class="btn btn-success">Add Keyword</a>
</div>

<div class="table-responsive table-container">
    <table class="table table-bordered table-hover table-sm">
        <thead class="table-dark">
            <tr>
                <th style="width: 50px;">SNo</th>
                <th style="min-width: 150px;">Keyword</th>
                <th style="min-width: 300px;">Message</th>
                <th style="width: 80px;">Edit</th>
                <th style="width: 90px;">Delete</th>
            </tr>
            <!-- Column-wise search row -->
            <tr>
                <th><input type="text" class="form-control form-control-sm column-search" placeholder="SNo" data-index="0"></th>
                <th><input type="text" class="form-control form-control-sm column-search" placeholder="Search Keyword" data-index="1"></th>
                <th><input type="text" class="form-control form-control-sm column-search" placeholder="Search Message" data-index="2"></th>
                <th></th>
                <th></th>
            </tr>
        </thead>
        <tbody id="keywordTableBody">
            {% for row in datas %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ row.key }}</td>
                <td>{{ row.message }}</td>
                <td><a href="{{ url_for('edit_botkeyword_updation', id=row.ID) }}" class="btn btn-sm btn-outline-primary">Edit</a></td>
                <td><a href="{{ url_for('delete_botkeyword_updation', id=row.ID) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure?')">Delete</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    // Column-wise search
    document.querySelectorAll('.column-search').forEach(function(input) {
        input.addEventListener('keyup', function () {
            const index = this.dataset.index;
            const filter = this.value.toLowerCase();
            const rows = document.querySelectorAll("#keywordTableBody tr");

            rows.forEach(row => {
                const cell = row.querySelectorAll("td")[index];
                const text = cell ? cell.textContent.toLowerCase() : "";
                row.style.display = text.includes(filter) ? "" : "none";
            });
        });
    });
</script>

{% endblock %}
